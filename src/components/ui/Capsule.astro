---
import { getLanguage } from "../../utils/languages";

interface Props {
  lang: string;
  size?: "xs" | "md";
  linkEnabled?: boolean;
}

const { size = "md", lang, linkEnabled = true } = Astro.props as Props;
const isTikTok = lang.startsWith("@");

// ---------- Emoji Map ----------
const emojiMap: Record<string, string> = {
  "@healxyz": "ðŸ§˜ðŸ½â€â™‚ï¸",
  "@luvnft": "ðŸ’œ",
  "@deliv3ry": "ðŸ“¦",
  "@rntbnb": "ðŸ¡",
  "@twerksocial": "ðŸ’ƒ",
  "@manifestppv": "ðŸ”®",
  "@rfptok": "ðŸŽ¯",
  "@rwatok": "ðŸ›ï¸",
  "@yenobet": "ðŸŽ°",
  "@foodcoins": "ðŸ¥—",
  "@ugcreviews": "â­",
  "@lumeebooth": "ðŸ“¸",
  "@aipromptok": "ðŸ¤–",
  "@smilesats": "ðŸ˜",

  // food / misc fallbacks
  "Nothing Bundt Cakes": "ðŸ§",
  "Wingstop": "ðŸ—",
  "Milk & Honey": "ðŸ¤",
  "Breakfast at Barney's": "ðŸ³",
};

const emoji =
  emojiMap[lang] ||
  Object.entries(emojiMap).find(([key]) => lang.includes(key))?.[1] ||
  "ðŸŽ¬";

// ---------- Base Classes ----------
const baseClasses = {
  container: [
    "flex items-center w-fit gap-1.5",
    "px-3 py-1.5",
    "text-sm font-semibold",
    "bg-white dark:bg-zinc-800",
    "text-zinc-800 dark:text-white",
    "rounded-full border border-mint-400",
    "transition-all duration-300 ease-in-out",
    "hover:scale-110 hover:shadow-[0_0_20px_rgba(13,188,130,0.3)]",
  ].join(" "),
};

const sizeClasses = {
  xs: "text-xs px-2 py-1",
  md: "text-sm px-3 py-1.5",
};

// ---------- Language Fallback ----------
let selectedLanguage: any = {};
if (!isTikTok) {
  selectedLanguage = getLanguage(lang);
}

const label = isTikTok ? lang : selectedLanguage?.name || lang;
const classes = `${baseClasses.container} ${sizeClasses[size]}`;
---

{linkEnabled ? (
  <a
    href={
      isTikTok
        ? `https://www.tiktok.com/${lang}`
        : `/blog/techs/${lang}`
    }
    target={isTikTok ? "_blank" : undefined}
    rel={isTikTok ? "noopener noreferrer" : undefined}
    class={classes}
    aria-label={label}
  >
    <span class="text-lg leading-none">{emoji}</span>
    <span>{label}</span>
  </a>
) : (
  <span class={`${classes} cursor-default`} aria-hidden="true">
    <span class="text-lg leading-none">{emoji}</span>
    <span>{label}</span>
  </span>
)}